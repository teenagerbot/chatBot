class ChatBot {
  //CREATING chat bot
	newMemory() {
		let user = arguments;
		let questions = [];
		let answers = [];
		let c = 0;
		let a = 0; 
		for (c; c < user.length; c++) {
			let question = user[c].match(/(\|([a-zA-Z0-9\s–∞-—è–ê-–Ø,\.%@#=$&\-+_:;'"*(){}<>\[\]~‚àÜ√∑√óœÄ‚àö‚Ä¢^¬∞¬•‚Ç¨¬¢¬£‚úì‚Ñ¢¬Æ¬©‚Ä∞‚ÑÖ]+))/gim) + ":";
			questions.push(question);
		} 
		for (a; a < user.length; a++) {
			let answer = user[a].replace(/(\|([a-zA-Z0-9\s–∞-—è–ê-–Ø,\.%@#=$&\-+_:;'"*(){}<>\[\]~‚àÜ√∑√óœÄ‚àö‚Ä¢^¬∞¬•‚Ç¨¬¢¬£‚úì‚Ñ¢¬Æ¬©‚Ä∞‚ÑÖ]+))/gim, "") + "|";
			answers.push(answer);
		}
		sessionStorage.setItem("questions", questions);
		sessionStorage.setItem("answers", answers);
	}
	newBot(time, ID, text, send, plac, image, lang) {
		let BOT = document.createElement("fieldset");
    let legend = document.createElement("legend");
		let input = document.createElement("input");
    let button = document.createElement("button");
    let message = document.createElement("nav");
    let imag = null;
    let TIME = null;
    sessionStorage.setItem("lang", lang);
    TIME = (time === false)?"no_time":"yes_time";
		sessionStorage.setItem("time", TIME);
		let content = document.querySelector("head").innerHTML;
    if (!content.includes(`<link rel="stylesheet" href="https://fonts.googleapis.com/icons?family=Material+Icons">`)) {
      let link = document.createElement("link");
      link.rel = "stylesheet";
			link.href = "https://fonts.googleapis.com/icon?family=Material+Icons";
			document.querySelector('head').appendChild(link);
		} else {
			return;
		}
		send = (send === "GI")?`<kk class="material-icons">send</kk>`:(send === "TI")?"<img src='https://chatBot.volodya-bot-developer.repl.co/tel.png' style='width:30px;'>":send;
    imag = ((image === "")||(image === false)||(image === null)||(image === undefined))?"-image:url('https://chatBot.volodya-bot-developer.repl.co/bot.png'); background-repeat:no-repeat; background-position:center; background-size:100%;":`-image:url("${image}"); background-repeat:no-repeat; background-position:center; background-size:100%;`;
    legend.innerHTML = text + " <cl>‚ùå</cl>";
		button.innerHTML = send;
		button.id = "___SEND_Bot_Message___";
    input.placeholder = plac;
		input.id = "___CHAT_Bot_Message___"
    input.style.cssText = `border: 2px blue solid; border-top-left-radius:20px;border-bottom-left-radius:20px;padding:10px;margin-right: 10px;`;
		button.style.cssText = `background: transparent; border: 2px blue solid; padding: 10px; border-top-right-radius:20px;border-bottom-right-radius:20px;width: fit-content; user-select:none;`;
		message.style.zIndex = "40";
    message.appendChild(input);
    message.appendChild(button);
		BOT.innerHTML += `<div id="___window_chat_bot___" style="width:100%;height:85%; display:block;margin-left:auto; margin-right:auto; overflow:scroll;"></div>`;
		BOT.appendChild(legend);
    BOT.appendChild(message);
		BOT.style.cssText = `width:80%;height: 400px;color: red;display: block; position fixed;top: 0%;bottom: 0;z-index: 30;left:0;right:0;margin: auto;border:3px blue solid;border-top:none; border-radius:17px; background${imag} overflow:scroll;`;
		BOT.className = "BOT_bot_for_CHAT";
		BOT.id = ID;
		message.style.cssText = `position: fixed;height:40px; display: block;top: 65%;`;
		document.querySelector('body').appendChild(BOT);
		document.querySelector("cl").onclick = () => {
			let bots = document.querySelectorAll(".BOT_bot_for_CHAT");
			for (let c = 0; c < bots.length; c++) {
				bots[c].remove();
			}
		}
	}
	deleteBot(ID) {
		document.querySelector(`#${ID}`).remove();
	}
  startBot() {
		let questions = [];
		let answers = [];
    questions = sessionStorage.getItem("questions").split(/:,?/gi);
    answers = sessionStorage.getItem("answers").split(/\|,?/gi);
		let time = sessionStorage.getItem("time");
		let lang = sessionStorage.getItem("lang");
		let botMessage = document.createElement("p");
    let sc = [1200, 1100, 1000, 2000, 1400, 1200, 1560, 1000];
		let x = null;
    botMessage.style.cssText = `border: 2px blue solid; border-radius:20px;width: fit-content;padding:6px; background:lightblue;`;
		let helloMessage = (lang === "ru")?"–ü—Ä–∏–≤–µ—Ç, —á–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?":(lang === "ua")?"–ü—Ä–∏–≤—ñ—Ç, —á–∏–º –º–æ–∂—É —Ç–æ–±—ñ –¥–æ–ø–æ–º–æ–≥—Ç–∏?":(lang === "en")?"Hello, how can I help?":(lang === "de")?"Hallo, wie kann ich helfen?":(lang === "es")?"Hola, ¬øc√≥mo puedo ayudar?":(lang === "fr")?"Bonjour, comment puis-je vous aider ?":(lang === "it")?"Ciao, come posso aiutarti?":(lang === "ja")?"„Åì„Çì„Å´„Å°„ÅØ„ÄÅ„Å©„ÅÜ„Åô„Çå„Å∞Êâã‰ºù„ÅÜ„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÅãÔºü":(lang === "ka")?"·Éí·Éê·Éõ·Éê·É†·ÉØ·Éù·Éë·Éê, ·É†·Éù·Éí·Éù·É† ·É®·Éî·Éõ·Éò·É´·Éö·Éò·Éê ·Éì·Éê·Éí·Éî·ÉÆ·Éõ·Éê·É†·Éù·Éó?":(lang === "pl")?"Witam w czym mogƒô pom√≥c?":(lang === "sr")?"–ó–¥—Ä–∞–≤–æ, –∫–∞–∫–æ –º–æ–≥—É –¥–∞ –ø–æ–º–æ–≥–Ω–µ–º?":(lang === "zh")?"ÊÇ®Â•ΩÔºåË´ãÂïèÊúâ‰ªÄÈ∫ºÂèØ‰ª•Âπ´ÂøôÁöÑÂóéÔºü":"Hello, how can I help?";
		let call = (lang === "ru")?"–ù–µ –ø–æ–Ω—è–ª, –µ—â—ë —Ä–∞–∑ —Å–∫–∞–∂–∏—Ç–µ –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ –≤–Ω—è—Ç–Ω–µ–µ ü§î":(lang === "ua")?"–ù–µ –∑—Ä–æ–∑—É–º—ñ–≤, —â–µ —Ä–∞–∑ —Å–∫–∞–∂—ñ—Ç—å –±—É–¥—å –ª–∞—Å–∫–∞ –≤–∏—Ä–∞–∑–Ω—ñ—à–µ ü§î":(lang === "en")?"I don't understand, please tell me more clearly ü§î":(lang === "de")?"Ich verstehe nicht, bitte sagen Sie es mir deutlicher ü§î":(lang === "es")?"No entiendo, por favor d√≠melo m√°s claro ü§î":(lang === "fr")?"Je ne comprends pas, s'il vous pla√Æt dites-moi plus clairement ü§î":(lang === "it")?"Non capisco, per favore dimmelo pi√π chiaramente ü§î":(lang === "ja")?"„Çè„Åã„Çä„Åæ„Åõ„Çì„ÄÅ„ÇÇ„Å£„Å®„ÅØ„Å£„Åç„ÇäÊïô„Åà„Å¶„Åè„Å†„Åï„ÅÑ ü§î":(lang === "ka")?"·Éê·É† ·Éõ·Éî·É°·Éõ·Éò·É°, ·Éí·Éó·ÉÆ·Éù·Éï ·É£·É§·É†·Éù ·Éí·Éê·É†·Éô·Éï·Éî·Éï·Éò·Éó ·Éõ·Éò·Éó·ÉÆ·Éê·É†·Éò ü§î":(lang === "pl")?"Nie rozumiem, proszƒô powiedz mi wyra≈∫niej ü§î":(lang === "sr")?"–ù–µ —Ä–∞–∑—É–º–µ–º, –º–æ–ª–∏–º —Ç–µ —Ä–µ—Ü–∏ –º–∏ —ò–∞—Å–Ω–∏—ò–µ ü§î":(lang === "zh")?"Ê≤íÁúãÊáÇÔºåË™™Ê∏ÖÊ•öÈªû ü§î":"I don't understand, please tell me more clearly ü§î";
		if (time === "no_time") {
			no_time();
		} else {
			yes_time();
		}
    function no_time() {
			botMessage.innerHTML = helloMessage;
			document.querySelector("#___window_chat_bot___").appendChild(botMessage);
			document.querySelector("#___SEND_Bot_Message___").onclick = () => {
				let user_message = document.querySelector("#___CHAT_Bot_Message___").value;
				if (user_message === "") {
					return;
				} else {
					let us_msg = document.createElement("p");
          us_msg.className = "___message___";
          us_msg.style.cssText = `border: 2px green solid; border-radius:20px;width: fit-content;padding:6px; display:block; position:relative;margin-left:auto; background:lightblue;z-index:10;`;
					us_msg.innerText = user_message;
					document.querySelector("#___window_chat_bot___").appendChild(us_msg);
					us_msg.scrollIntoView({
								behavior:"smooth"
				});
					document.querySelector("#___CHAT_Bot_Message___").value = "";
          for(let ca = 0; ca < questions.length; ca++) {
						if (questions[ca].includes(user_message)) {
							let p = document.createElement("p");
              p.innerText = answers[ca];
              p.style.cssText = `border: 2px blue solid; border-radius:20px;width: fit-content;padding:6px;background:lightblue;`;
							let type = document.createElement("img");
              type.src = "load.gif";
              type.style.cssText = `width:50px;`;
							document.querySelector("#___window_chat_bot___").appendChild(type);
							type.scrollIntoView({
								behavior:"smooth"
							});
              setTimeout(function() {
								document.querySelector("#___window_chat_bot___").removeChild(type);
                document.querySelector("#___window_chat_bot___").appendChild(p); 
								x = sc[Math.floor(Math.random()*sc.length)];
							}, x);
							break;
						} else if (!questions[ca].includes(user_message) && ca == questions.length-1) {
							let err = document.createElement("p");
              err.innerHTML = "¬Ø\\_(„ÉÑ)_/¬Ø";
              err.style.cssText = `border: 2px blue solid; border-radius:20px;width: fit-content;padding:6px;background:lightblue;`;
							let type = document.createElement("img");
              type.src = "load.gif";
              type.style.cssText = `width:50px;`;
							document.querySelector("#___window_chat_bot___").appendChild(type);
							type.scrollIntoView({
								behavior:"smooth"
							});
              setTimeout(function() {
								document.querySelector("#___window_chat_bot___").removeChild(type);
                document.querySelector("#___window_chat_bot___").appendChild(err); 
								x = sc[Math.floor(Math.random()*sc.length)];
							}, x);
						}
					}
				}
			}
		}
		function yes_time() {
      let hate = new Date();
			let min = hate.getHours();
			let sec = hate.getMinutes();
			botMessage.innerHTML = helloMessage + "<tm style='font-size:10px;'>" + min + ":" + sec + "</tm>";
			document.querySelector("#___window_chat_bot___").appendChild(botMessage);
			document.querySelector("#___SEND_Bot_Message___").onclick = () => {
				let user_message = document.querySelector("#___CHAT_Bot_Message___").value;
				if (user_message === "") {
					return;
				} else {
					let us_msg = document.createElement("p");
          us_msg.className = "___message___";
          us_msg.style.cssText = `border: 2px green solid; border-radius:20px;width: fit-content;padding:6px; display:block; position:relative;margin-left:auto; background:lightblue;`;
					us_msg.innerText = user_message;
					let min = hate.getHours();
			    let sec = hate.getMinutes();
					us_msg.innerHTML += " <tm style='font-size:10px;'>" + min + ":" + sec + "</tm>";
					document.querySelector("#___window_chat_bot___").appendChild(us_msg);
					document.querySelector("#___CHAT_Bot_Message___").value = "";
					for(let ca = 0; ca < questions.length; ca++) {
						if (questions[ca].includes(user_message)) {
							let p = document.createElement("p");
              p.innerText = answers[ca];
							p.innerHTML += ` <tm style='font-size:10px;'>${hate.getHours()}:${hate.getMinutes()}</tm>`;
              p.style.cssText = `border: 2px blue solid; border-radius:20px;width: fit-content;padding:6px;background:lightblue;`;
							let type = document.createElement("img");
              type.src = "load.gif";
              type.style.cssText = `width:50px;`;
							document.querySelector("#___window_chat_bot___").appendChild(type);
							type.scrollIntoView({
								behavior:"smooth"
							});
              setTimeout(function() {
								document.querySelector("#___window_chat_bot___").removeChild(type);
                document.querySelector("#___window_chat_bot___").appendChild(p); 
								x = sc[Math.floor(Math.random()*sc.length)];
							}, x);
							break;
						} else if (!questions[ca].includes(user_message) && ca == questions.length-1) {
							let err = document.createElement("p");
              err.innerHTML = "¬Ø\\_(„ÉÑ)_/¬Ø" + ` <tm style='font-size:10px;'>${hate.getHours()}:${hate.getMinutes()}</tm>`;
              err.style.cssText = `border: 2px blue solid; border-radius:20px;width: fit-content;padding:6px;background:lightblue;`;
							let type = document.createElement("img");
              type.src = "load.gif";
              type.style.cssText = `width:50px;`;
							document.querySelector("#___window_chat_bot___").appendChild(type);
							type.scrollIntoView({
								behavior:"smooth"
							});
              setTimeout(function() {
								document.querySelector("#___window_chat_bot___").removeChild(type);
                document.querySelector("#___window_chat_bot___").appendChild(err); 
								x = sc[Math.floor(Math.random()*sc.length)];
							}, x);
						}
					}
				}
			}
		}
	}
	stopBot(ID) {
		let input = document.querySelector(`#${ID} input`);
    input.setAttribute("readonly", true);
	}
	deleteChat(ID) {
		while(document.querySelector(`#${ID} div`)){
       document.querySelector(`#${ID} div`).removeChild(document.querySelector(`#${ID} div`).firstChild);
    }
	}
}